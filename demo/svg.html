<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
      }
      .operation {
        position: fixed;
        top: 0px;
        left: 0;
        right: 0;
        border-bottom: 4px solid pink;
      }
      svg,
      g {
        transition: all 0.1s linear;
      }
    </style>
  </head>
  <body>
    <svg
      version="1.1"
      width="100%"
      height="80px"
      xmlns="http://www.w3.org/2000/svg"
      class="operation"
    >
      <!-- <rect rx="10" width="100" height="60" />
      <ellipse cx="160" cy="30" rx="20" ry="20" /> -->
      <g transform="translate(0 0)">
        <rect
          id="love1"
          rx="6"
          x="20"
          y="20"
          width="100"
          height="40"
          style="
            fill: blue;
            stroke: pink;
            stroke-width: 3;
            fill-opacity: 0.1;
            stroke-opacity: 0.9;
          "
        />
      </g>
      <g transform="translate(160 0)">
        <circle
          cx="20"
          cy="40"
          r="20"
          stroke="pink"
          stroke-width="3"
          fill="blue"
          style="fill-opacity: 0.1; stroke-opacity: 0.9"
        />
      </g>
      <g transform="translate(240 0)">
        <polygon
          points="20,20 40,40 20,60 0,40"
          style="fill: blue; stroke: pink; stroke-width: 3; fill-opacity: 0.1"
        />
      </g>
      <!-- <path
        d="M10 10 C 70 140, 110 140, 110 110 H 80 V 90 H 10 Z"
        fill="transparent"
        stroke="black"
      /> -->
    </svg>

    <svg
      id="svg"
      version="1.1"
      width="100%"
      height="100%"
      xmlns="http://www.w3.org/2000/svg"
    >
    <defs>
      <marker
        id="triangle"
        markerUnits="strokeWidth"
        markerWidth="5"
        markerHeight="4"
        refX="0"
        refY="2"
        orient="auto"
      >
        <path d="M 0 0 L 5 2 L 0 4 z" />
      </marker>
    </defs>
      <g id="gg" transform="translate(0 0)">
        <rect
          id="love1"
          rx="6"
          x="20"
          y="20"
          width="100"
          height="40"
          style="
            fill: blue;
            stroke: pink;
            stroke-width: 3;
            fill-opacity: 0.1;
            stroke-opacity: 0.9;
          "
        />
      </g>

      <g id="gg2" data-x="0" data-y="120" transform="translate( 0 120 )"><path d="M 50, -80 L 50, -10" stroke="black" stroke-width="2" style="marker-end: url(#triangle);"></path><rect rx="6" x="0" y="0" style="fill: blue; stroke: pink; stroke-width: 3; fill-opacity: 0.1; stroke-opacity: 0.9;" width="100" height="40"></rect><text y="20">开始</text></g>

      <g id="gg2" data-x="120" data-y="120" transform="translate( 120 120 )">
        <path d="M -70 -70 l 120 0 l 0 60" fill="none" stroke="#000" stroke-width="2px" style="marker-end: url(#triangle);" />著作权归作者所有。
        <rect rx="6" x="0" y="0" style="fill: blue; stroke: pink; stroke-width: 3; fill-opacity: 0.1; stroke-opacity: 0.9;" width="100" height="40"></rect>
        <text y="20">开始</text>
      </g>

      <g id="gg2" data-x="120" data-y="120" transform="translate( 240 120 )">
        <path d="M -70 -70 l 120 0 l 0 60" fill="none" stroke="#000" stroke-width="2px" style="marker-end: url(#triangle);" />著作权归作者所有。
        <rect rx="6" x="0" y="0" style="fill: blue; stroke: pink; stroke-width: 3; fill-opacity: 0.1; stroke-opacity: 0.9;" width="100" height="40"></rect>
        <text y="20">开始</text>
      </g>
      <!-- <g id="gg" transform="translate(400, 120)">
        <rect rx="5" width="200" height="40" />
        <g transform="translate( 400 60 )">
          <ellipse cx="75" cy="75" rx="20" ry="20" />
        </g>
      </g> -->

      <!-- <g transform="translate( 400 9002 )">
        <circle cx="10" cy="100" r="30" fill="green" />
      </g> -->

      <!-- <line
        x1="10"
        x2="50"
        y1="110"
        y2="150"
        fill="none"
        stroke="blue"
        stroke-width="5"
      />
      <path
        d="M20,230 Q40,205 50,230 T90,230"
        fill="none"
        stroke="blue"
        stroke-width="5"
      />
      <polyline
        points="60 110, 65 120, 70 115, 75 130, 80 125, 85 140, 90 135, 95 150, 100 145"
        fill="none"
        stroke="blue"
        stroke-width="5"
      />
      <polygon
        points="50 160, 55 180, 70 180, 60 190, 65 205, 50 195, 35 205, 40 190, 30 180, 45 180"
        fill="none"
        stroke="blue"
      /> -->
      <!-- <text x="150" y="125" font-size="60" text-anchor="middle" fill="white">
        SVG
      </text> -->

      <!-- <path d="M10 10" /> -->

      <!-- Points -->
      <!-- <circle cx="10" cy="10" r="2" fill="red" />

      <path d="M10 10 H 80 V 90 H 6 Z" fill="transparent" stroke="black" />

      <path d="M10 20 h 80 v 100 h -80 Z" fill="transparent" stroke="red" /> -->
    </svg>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script>
      const threshold = 3.5;
      //参考百度脑图，通过transform wheel 滚动
      class AutoGOGO {
        constructor() {
          this.el = document.getElementById("svg");
          this.mainGG = document.getElementById("gg");
          this.init();
        }
        init() {
          console.log(this);
          // 绑定事件监听
          // 1.绑定滚轮事件
          this.addEvent("wheel", (e) => {
            const { x, y } = this.getLocation();
            const dataX = x + Math.floor(e.wheelDeltaX / threshold);
            const dataY = y + Math.floor(e.wheelDeltaY / threshold);
            this.setLocation(dataX, dataY);
          });

          this.rectifyLocation();
        }
        rectifyLocation(el = this.mainGG) {
          const { width, height } = this.getEleRect();
          const x = document.body.clientWidth / 2 - width / 2;
          const y = document.body.clientHeight / 2 - height / 2;
          console.log(x, y, width);
          this.setLocation(x, y);
        }
        addEvent(type, cb) {
          this.el.addEventListener(type, cb, false);
        }
        setLocation(x, y, el = this.mainGG) {
          // @TODO:可以考虑放在内存里
          el.setAttribute("data-x", x);
          el.setAttribute("data-y", y);
          el.setAttribute("transform", `translate( ${x} ${y} )`);
        }
        getLocation(el = this.mainGG) {
          // el.getBoundingClientRect
          return {
            x: el.getAttribute("data-x") * 1,
            y: el.getAttribute("data-y") * 1,
          };
        }
        getEleRect(el = this.mainGG) {
          const { width, height } = el.getBoundingClientRect();
          return {
            width,
            height,
          };
        }
      }

      new AutoGOGO();

      /**
       * 相关api
       * document.body.clientWidth
       * document.body.clientHeight
       * el.getBoundingClientRect
       **/
    </script>
  </body>
</html>
